<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Common neighbor analysis &mdash; OVITO User Manual 3.10.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/style.css" />

  
    <link rel="shortcut icon" href="../../../_static/ovito.ico"/>
    <link rel="canonical" href="https://docs.ovito.org/reference/pipelines/modifiers/common_neighbor_analysis.html" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Compute property" href="compute_property.html" />
    <link rel="prev" title="Combine datasets" href="combine_particle_sets.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/ovito_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.10.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">About OVITO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../new_features.html">What's new</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage/index.html">Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../advanced_topics/index.html">Advanced topics</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Pipelines</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../data_sources/index.html">Data sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data_objects/index.html">Data objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../visual_elements/index.html">Visual elements</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Modifiers</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="bond_angle_analysis.html">Ackland-Jones analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="affine_transformation.html">Affine transformation</a></li>
<li class="toctree-l4"><a class="reference internal" href="ambient_occlusion.html">Ambient occlusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="assign_color.html">Assign color</a></li>
<li class="toctree-l4"><a class="reference internal" href="atomic_strain.html">Atomic strain</a></li>
<li class="toctree-l4"><a class="reference internal" href="bond_analysis.html">Bond analysis <span class="ovito-pro-tag-role"><a class="ovito-pro-tag" href="https://www.ovito.org/#proFeatures" data-tooltip="This program feature is only available in OVITO Pro and not OVITO Basic. Click to learn more." data-tooltip-position="right">pro</a></span></a></li>
<li class="toctree-l4"><a class="reference internal" href="calculate_local_entropy.html">Calculate local entropy <span class="ovito-pro-tag-role"><a class="ovito-pro-tag" href="https://www.ovito.org/#proFeatures" data-tooltip="This program feature is only available in OVITO Pro and not OVITO Basic. Click to learn more." data-tooltip-position="right">pro</a></span></a></li>
<li class="toctree-l4"><a class="reference internal" href="centrosymmetry.html">Centrosymmetry parameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="chill_plus.html">Chill+</a></li>
<li class="toctree-l4"><a class="reference internal" href="clear_selection.html">Clear selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="cluster_analysis.html">Cluster analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="color_by_type.html">Color by type <span class="ovito-pro-tag-role"><a class="ovito-pro-tag" href="https://www.ovito.org/#proFeatures" data-tooltip="This program feature is only available in OVITO Pro and not OVITO Basic. Click to learn more." data-tooltip-position="right">pro</a></span></a></li>
<li class="toctree-l4"><a class="reference internal" href="color_coding.html">Color coding</a></li>
<li class="toctree-l4"><a class="reference internal" href="combine_particle_sets.html">Combine datasets</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Common neighbor analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="compute_property.html">Compute property</a></li>
<li class="toctree-l4"><a class="reference internal" href="construct_surface_mesh.html">Construct surface mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="coordination_analysis.html">Coordination analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="coordination_polyhedra.html">Coordination polyhedra</a></li>
<li class="toctree-l4"><a class="reference internal" href="create_bonds.html">Create bonds</a></li>
<li class="toctree-l4"><a class="reference internal" href="create_isosurface.html">Create isosurface</a></li>
<li class="toctree-l4"><a class="reference internal" href="delete_selected_particles.html">Delete selected</a></li>
<li class="toctree-l4"><a class="reference internal" href="dislocation_analysis.html">Dislocation analysis (DXA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="displacement_vectors.html">Displacement vectors</a></li>
<li class="toctree-l4"><a class="reference internal" href="elastic_strain.html">Elastic strain calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="expand_selection.html">Expand selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="expression_select.html">Expression selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="freeze_property.html">Freeze property</a></li>
<li class="toctree-l4"><a class="reference internal" href="generate_trajectory_lines.html">Generate trajectory lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="grain_segmentation.html">Grain segmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="histogram.html">Histogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="identify_diamond.html">Identify diamond structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="identify_fcc_planar_faults.html">Identify fcc planar faults <span class="ovito-pro-tag-role"><a class="ovito-pro-tag" href="https://www.ovito.org/#proFeatures" data-tooltip="This program feature is only available in OVITO Pro and not OVITO Basic. Click to learn more." data-tooltip-position="right">pro</a></span></a></li>
<li class="toctree-l4"><a class="reference internal" href="interactive_molecular_dynamics.html">Interactive molecular dynamics (IMD)</a></li>
<li class="toctree-l4"><a class="reference internal" href="invert_selection.html">Invert selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="load_trajectory.html">Load trajectory</a></li>
<li class="toctree-l4"><a class="reference internal" href="manual_selection.html">Manual selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="polyhedral_template_matching.html">Polyhedral template matching</a></li>
<li class="toctree-l4"><a class="reference internal" href="python_script.html">Python script <span class="ovito-pro-tag-role"><a class="ovito-pro-tag" href="https://www.ovito.org/#proFeatures" data-tooltip="This program feature is only available in OVITO Pro and not OVITO Basic. Click to learn more." data-tooltip-position="right">pro</a></span></a></li>
<li class="toctree-l4"><a class="reference internal" href="render_lammps_regions.html">Render LAMMPS regions <span class="ovito-pro-tag-role"><a class="ovito-pro-tag" href="https://www.ovito.org/#proFeatures" data-tooltip="This program feature is only available in OVITO Pro and not OVITO Basic. Click to learn more." data-tooltip-position="right">pro</a></span></a></li>
<li class="toctree-l4"><a class="reference internal" href="show_periodic_images.html">Replicate</a></li>
<li class="toctree-l4"><a class="reference internal" href="scatter_plot.html">Scatter plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="select_particle_type.html">Select type</a></li>
<li class="toctree-l4"><a class="reference internal" href="shrink_wrap_box.html">Shrink-wrap simulation box <span class="ovito-pro-tag-role"><a class="ovito-pro-tag" href="https://www.ovito.org/#proFeatures" data-tooltip="This program feature is only available in OVITO Pro and not OVITO Basic. Click to learn more." data-tooltip-position="right">pro</a></span></a></li>
<li class="toctree-l4"><a class="reference internal" href="slice.html">Slice</a></li>
<li class="toctree-l4"><a class="reference internal" href="smooth_trajectory.html">Smooth trajectory</a></li>
<li class="toctree-l4"><a class="reference internal" href="bin_and_reduce.html">Spatial binning <span class="ovito-pro-tag-role"><a class="ovito-pro-tag" href="https://www.ovito.org/#proFeatures" data-tooltip="This program feature is only available in OVITO Pro and not OVITO Basic. Click to learn more." data-tooltip-position="right">pro</a></span></a></li>
<li class="toctree-l4"><a class="reference internal" href="correlation_function.html">Spatial correlation function</a></li>
<li class="toctree-l4"><a class="reference internal" href="time_averaging.html">Time averaging <span class="ovito-pro-tag-role"><a class="ovito-pro-tag" href="https://www.ovito.org/#proFeatures" data-tooltip="This program feature is only available in OVITO Pro and not OVITO Basic. Click to learn more." data-tooltip-position="right">pro</a></span></a></li>
<li class="toctree-l4"><a class="reference internal" href="time_series.html">Time series <span class="ovito-pro-tag-role"><a class="ovito-pro-tag" href="https://www.ovito.org/#proFeatures" data-tooltip="This program feature is only available in OVITO Pro and not OVITO Basic. Click to learn more." data-tooltip-position="right">pro</a></span></a></li>
<li class="toctree-l4"><a class="reference internal" href="unwrap_trajectories.html">Unwrap trajectories</a></li>
<li class="toctree-l4"><a class="reference internal" href="voronoi_analysis.html">Voronoi analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="vorotop_analysis.html">VoroTop analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="wigner_seitz_analysis.html">Wigner-Seitz defect analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="wrap_at_periodic_boundaries.html">Wrap at periodic boundaries</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../viewports/index.html">Viewports</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rendering/index.html">Rendering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_inspector/index.html">Data inspector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../app_settings/index.html">Application settings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../ovito_pro.html">OVITO Pro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development/index.html">Developer instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../licenses/index.html">Licensing information</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">OVITO User Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          

<div role="navigation" aria-label="Breadcrumbs">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Reference</a> &raquo;</li>
          <li><a href="../index.html">Pipelines</a> &raquo;</li>
          <li><a href="index.html">Modifiers</a> &raquo;</li>
      <li>Common neighbor analysis</li>
      <li class="wy-breadcrumbs-aside" style="text-align: right;">
          <a href="https://www.ovito.org" style="padding: 1px;"">www.ovito.org&nbsp;<span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a><br>
          <a href="../../../python/index.html" style="padding: 1px;">Python&nbsp;Reference&nbsp;<span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="particles-modifiers-common-neighbor-analysis">
<span id="common-neighbor-analysis"></span><h1>Common neighbor analysis<a class="headerlink" href="#particles-modifiers-common-neighbor-analysis" title="Permalink to this heading"></a></h1>
<a class="reference internal image-reference" href="../../../_images/common_neighbor_analysis_panel.png"><img alt="../../../_images/common_neighbor_analysis_panel.png" class="align-right" src="../../../_images/common_neighbor_analysis_panel.png" style="width: 30%;" /></a>
<p>This analysis modifier performs the <em>Common Neighbor Analysis</em> (CNA) [<a class="reference external" href="http://dx.doi.org/10.1021/j100303a014">Honeycutt and Andersen, J. Phys. Chem. 91, 4950</a>]
for a particle system. The CNA is an algorithm to compute a fingerprint for
pairs of atoms, which is designed to characterize the local structural environment.
Typically, the CNA is used as an effective filtering method to classify atoms in crystalline systems
[<a class="reference external" href="http://dx.doi.org/10.1016/0927-0256(94)90109-0">Faken and Jonsson, Comput. Mater. Sci. 2, 279</a>],
with the goal to get a precise understanding of which atoms are associated with which phases,
and which are associated with defects.</p>
<p>The modifier supports four different modes of operation:</p>
<dl class="simple">
<dt>Conventional CNA (with fixed cutoff)</dt><dd><p>Here, a threshold distance criterion is used to determine whether a pair of atoms
is bonded or not. The cutoff distance must be chosen
according to the crystal structure at hand. For face-centered cubic (FCC)
and hexagonal close-packed (HCP) structures the cutoff radius must lie midway between
the first and the second shell of neighbors.
For body-centered cubic (BCC) structures the cutoff radius should be positioned
between the second and the third neighbor shell. OVITO provides a list of
optimal cutoff distances for FCC and BCC crystal structures formed by common pure
elements. These optimal radii can be found in the <span class="guilabel">Presets</span>
drop-down list.</p>
</dd>
<dt>Adaptive CNA (with variable cutoff)</dt><dd><p>Sometimes it may be difficult to choose the right cutoff radius for the conventional CNA, in particular in the
case of multiphase systems. This is why an adaptive version of the CNA has been
developed that works without a fixed cutoff. The
<em>Adaptive Common Neighbor Analysis</em> (a-CNA) method [<a class="reference external" href="http://dx.doi.org/10.1088/0965-0393/20/4/045021">Stukowski, Modell. Simul. Mater. Sci. Eng. 20, 045021</a>]
determines the optimal cutoff radius automatically for each individual particle.</p>
</dd>
<dt>Interval CNA (with variable cutoff)</dt><dd><p>Sometimes an appropriate cutoff cannot be found using either the conventional CNA <em>or</em> the adaptive CNA,
in particular at elevated temperatures. In this case the <em>Interval Common Neighbor Analysis</em> (i-CNA) method [<a class="reference external" href="https://arxiv.org/abs/2003.08879">Larsen</a>]
may be used. For each particle it investigates all possible threshold choices. This is slower than the other methods but has a
better recognition rate.</p>
</dd>
<dt>Bond-based CNA (without cutoff)</dt><dd><p>The modifier also supports a bond-based mode of operation. Then the CNA indices
are computed based on the existing network of bonds between particles (without using a cutoff radius
and irrespective of the distance between particles). This mode requires that bonds between
particles have previously been defined, for example using a <a class="reference internal" href="create_bonds.html#particles-modifiers-create-bonds"><span class="std std-ref">Create bonds</span></a> modifier
or by loading them from a data file. In the bond-based mode, the modifier
outputs the computed per-bond CNA indices as a new bond property named <code class="docutils literal notranslate"><span class="pre">CNA</span> <span class="pre">indices</span></code>,
which can be used for further statistical analyses.
The computed CNA bond indices may be accessed from a Python script, <a class="reference external" href="../../../python/introduction/examples/batch_scripts/cna_bond_indices.html#example-compute-cna-bond-indices" title="(in OVITO Python Reference v3.10.4)"><span class="xref std std-ref">see this example</span></a>.</p>
</dd>
</dl>
<section id="modifier-outputs">
<h2>Modifier outputs<a class="headerlink" href="#modifier-outputs" title="Permalink to this heading"></a></h2>
<p>The modifier outputs the classification results as a new particle property named <code class="docutils literal notranslate"><span class="pre">Structure</span> <span class="pre">Type</span></code>.
This information allows you to subsequently select particles of a certain structural type, e.g. using the
<a class="reference internal" href="select_particle_type.html#particles-modifiers-select-particle-type"><span class="std std-ref">Select type</span></a> modifier.
The structural type determined by the algorithm is encoded as an integer value:</p>
<ul class="simple">
<li><p>0 = Other, unknown coordination structure</p></li>
<li><p>1 = FCC, face-centered cubic</p></li>
<li><p>2 = HCP, hexagonal close-packed</p></li>
<li><p>3 = BCC, body-centered cubic</p></li>
<li><p>4 = ICO, icosahedral coordination</p></li>
</ul>
<p>In addition, the modifier assigns colors to the particles (by setting the <code class="docutils literal notranslate"><span class="pre">Color</span></code>
particle property) to indicate their computed structural type. The color representing each structural type
can be customized by double-clicking the corresponding entry in the table or, permanently, in the <a class="reference internal" href="../../app_settings/particle_settings.html#application-settings-particles"><span class="std std-ref">application settings dialog</span></a>.</p>
<p>Furthermore, the modifier emits <a class="reference internal" href="../../../usage/export.html#usage-global-attributes"><span class="std std-ref">global attributes</span></a> to the data pipeline reporting the total number of particles matching
each of the supported structural types. These attributes are named <code class="docutils literal notranslate"><span class="pre">CommonNeighborAnalysis.counts.XXX</span></code>, where “XXX”
stands for the name of each structure supported by the modifier. These analysis statistics may be exported using OVITO’s <a class="reference internal" href="../../../usage/export.html#usage-export"><span class="std std-ref">data export function</span></a>
or displayed as live information in the viewports using a <a class="reference internal" href="../../viewports/layers/text_label_layer.html#viewport-layers-text-label"><span class="std std-ref">text label</span></a> layer.</p>
</section>
<section id="usage-notes">
<h2>Usage notes<a class="headerlink" href="#usage-notes" title="Permalink to this heading"></a></h2>
<p>The modifier needs to see the complete set of input particles to perform the analysis. It should therefore be placed at the
beginning of the data pipeline, preceding any modifiers that delete some of the particles.</p>
<p>The option <span class="guilabel">Use only selected particles</span> restricts the analysis to the
currently selected particles. In this case, unselected particles will be ignored
(as if they did not exist) and are all assigned the structure type “Other”.
This option is useful if you want to identify defects in a crystal type
not directly supported by the common neighbor analysis algorithm but having a sub-lattice that is supported.</p>
</section>
<section id="alternatives">
<h2>Alternatives<a class="headerlink" href="#alternatives" title="Permalink to this heading"></a></h2>
<p>OVITO provides implementations of other structure identification methods, for instance the
<a class="reference internal" href="bond_angle_analysis.html#particles-modifiers-bond-angle-analysis"><span class="std std-ref">Ackland-Jones analysis</span></a> modifier,
the <a class="reference internal" href="identify_diamond.html#particles-modifiers-identify-diamond-structure"><span class="std std-ref">Identify diamond structure</span></a> modifier or
the <a class="reference internal" href="polyhedral_template_matching.html#particles-modifiers-polyhedral-template-matching"><span class="std std-ref">Polyhedral template matching</span></a> modifier.
Furthermore, the <a class="reference internal" href="centrosymmetry.html#particles-modifiers-centrosymmetry"><span class="std std-ref">Centrosymmetry parameter</span></a> modifier can also be used to
detect defects in crystal lattices.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="../../../python/modules/ovito_modifiers.html#ovito.modifiers.CommonNeighborAnalysisModifier" title="(in OVITO Python Reference v3.10.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ovito.modifiers.CommonNeighborAnalysisModifier</span></code></a> (Python API)</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="combine_particle_sets.html" class="btn btn-neutral float-left" title="Combine datasets" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="compute_property.html" class="btn btn-neutral float-right" title="Compute property" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024 OVITO GmbH, Germany.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>